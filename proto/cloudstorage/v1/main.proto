syntax = "proto3";

package cloudstorage.v1;

import "cloudstorage/v1/types.proto";

service CloudStorageService {
  rpc UploadFile(stream UploadFileRequest) returns (UploadFileResponse);

  rpc GetFile(GetFileRequest) returns (stream GetFileResponse);

  rpc DeleteFile(DeleteFileRequest) returns (DeleteFileResponse);

  rpc ChangeVisibility(ChangeVisibilityRequest) returns (ChangeVisibilityResponse);

  rpc CreateDirectory(CreateDirectoryRequest) returns (CreateDirectoryResponse);

  rpc GetDirectoryContent(GetDirectoryContentRequest) returns (GetDirectoryContentResponse);
}

message UploadFileRequest {
  bytes data = 1;
}

enum Status {
  STATUS_UNSPECIFIED = 0;
  STATUS_FAILED = 1;
  STATUS_SUCCESS = 2;
}

message UploadFileResponse {
  Status status = 1;
  oneof response {
    string error_message = 2;
    cloudstorage.v1.FileDetails file_details = 3;
  }
}

message GetFileRequest {
  string file_id = 1;
}

message GetFileResponse {
  bytes data = 1;
}

message DeleteFileRequest {
  repeated string file_ids = 1;
}
message DeleteFileResponse {
  repeated string file_ids = 1;
}

message ChangeVisibilityRequest {
  repeated cloudstorage.v1.FileAccessInfo file_data= 1;
}

message ChangeVisibilityResponse {
  repeated cloudstorage.v1.FileAccessInfo file_data= 1;
}

message CreateDirectoryRequest {
  string directory_id = 1;
  cloudstorage.v1.AccessType access_type = 2;
}

message CreateDirectoryResponse {
  string directory_id = 1;
  cloudstorage.v1.AccessType access_type = 2;
}

enum ContentType{
    CONTENT_TYPE_UNSPECIFIED = 0;
    CONTENT_TYPE_ALL = 1;
    CONTENT_TYPE_DIRECTORY = 2;
    CONTENT_TYPE_FILES = 3;
}
message GetDirectoryContentRequest{
  string directory_id = 1;
  ContentType required_content_type = 2;
}
message GetDirectoryContentResponse{
  string content_id = 1;
  ContentType content_type = 2;
  uint64 content_size = 3;
  string created_on = 4;
}
